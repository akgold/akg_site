<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.53" />


<title>Upgrading to R #4: It Takes a Team to Write a Package - Alex K Gold Blog</title>
<meta property="og:title" content="Upgrading to R #4: It Takes a Team to Write a Package - Alex K Gold Blog">



  







<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/akg_profile.jpg"
         width="50"
         height="50"
         alt="It Me">
  </a>

  <ul class="nav-links">
    
    <li><a href="/about/">Alex K Gold</a></li>
    
    <li><a href="https://github.com/akgold">GitHub</a></li>
    
    <li><a href="https://twitter.com/alexkgold">Twitter</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">3 min read</span>
    

    <h1 class="article-title">Upgrading to R #4: It Takes a Team to Write a Package</h1>

    
    <span class="article-date">2019/02/27</span>
    

    <div class="article-content">
      


<p>As you’re upgrading to R, you’ll be writing a lot of code. As the ever-quotable <a href="https://twitter.com/drob/">David Robinson</a> says</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">When you’ve written the same code 3 times, write a function<br><br>When you’ve given the same in-person advice 3 times, write a blog post</p>&mdash; David Robinson (@drob) <a href="https://twitter.com/drob/status/928447584712253440?ref_src=twsrc%5Etfw">November 9, 2017</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>What he said! And then if you find yourself writing the same function three times, write a package!</p>
<p>I know I’m not exactly breaking new territory to say that writing <a href="https://medium.com/airbnb-engineering/using-r-packages-and-education-to-scale-data-science-at-airbnb-906faa58e12d">an R package</a> <a href="https://blog.craftlab.hu/from-0-to-5-our-journey-of-building-an-r-package-ecosystem-ec257818e425">with your team</a> <a href="https://hilaryparker.com/2014/04/29/writing-an-r-package-from-scratch/">is great</a>, and there are really great resources for <em>how</em> to write a package.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> I’ll just add that mastering R packages will make you feel like a wizard, and that is always cool.</p>
<div class="figure">
<img src="/post/2019-02-27-upgrading-to-r-4-write-a-package_files/wizard.gif" alt="Master of R packages." />
<p class="caption">Master of R packages.</p>
</div>
<p>Obviously other people have covered the why and how in exhausting detail. What I’d like to talk about in the context of <a href="/2019/01/19/upgrading-to-r-at-rstudio-conf-2019/">upgrading to R</a> is how to make sure your R packages <em>actually get used</em>, which is mostly about the <strong>what</strong>’s in the package, and <strong>who</strong> built it.</p>
<p><img src="/post/2019-02-27-upgrading-to-r-4-write-a-package_files/figure-html/pkg-1.gif" /><!-- --></p>
<div id="what-belongs-in-your-teams-r-package" class="section level1">
<h1>What Belongs in Your Team’s R Package</h1>
<p>As in the <code>gif</code> above, your R package can have lots of useful things in it, but here are things that I’ve frequently used in packages on my team:</p>
<div id="dplyr-function-wrappers" class="section level3">
<h3><code>dplyr</code> function wrappers</h3>
<p>In my opinion, this is probably the most useful, especially if your team has a lot of junior members. Many times students aren’t exposed to the weirdness of real data, and so providing some automated checks can be super helpful. Some functions we’ve created wrappers with diagnostics:</p>
<ul>
<li><code>recode2</code>, which wraps <code>dplyr::recode</code> with a cross-table of the values before and after recoding</li>
<li><code>join2</code>, which wraps <code>dplyrs</code> join functions providing diganostics on how many rows did or didn’t join and whether there’s duplicated IDs</li>
<li><code>read_in</code>, which wraps <code>readr::read_delim</code> and prints the first few rows upon import -<code>filter2</code>, which wraps <code>dplyr::filter</code> and lets you know how many rows got dropped</li>
</ul>
</div>
<div id="reference-data-sets" class="section level3">
<h3>Reference data sets</h3>
<p>Keeping reference data sets in an R package is an easy way to keep them synced (especially if you’re in a <a href="/2019/02/20/upgrading-to-r-3-be-the-data-engineer-they-need/"><code>csv</code>-driven data environment</a>). For example, we had a list of facility names that we frequently matched into other data. Putting the dataset of facility names and an <code>add_facility_names</code> function removed one source of friction in our workflow.</p>
</div>
<div id="plotting-functions" class="section level3">
<h3>Plotting Functions</h3>
<p>Depending on your applications, you might use the same plots all the time. For example, I was once in a job where we were constantly outputting bar charts with error bars. Building out these plots in <code>ggplot2</code> wasn’t a huge pain, but putting those default plots into a package made the outputting process super easy.</p>
</div>
<div id="openxlsx-or-googlesheets-wrappers-with-formatting" class="section level2">
<h2><code>openxlsx</code> or <code>googlesheets</code> wrappers with formatting</h2>
<p>In many consulting environments, clients or customers want you to <em>make</em> spreadsheets for them to play with. It’s easy to create an R workflow to generate data frames that can be dumped into a Google Sheet or Excel workbook, but manually styling your creations every time is a pain (especially if you frequently find yourself updating the same numbers and having to re-style every time.) Writing some wrapper functions that can write the data out to a spreadsheet while also doing styling can make this annoying task much easier.</p>
<div id="special-analytical-functions" class="section level3">
<h3>Special analytical functions</h3>
<p>When I was full-time doing experiments in political data world, we were constantly running particular kinds of regressions and predictive margins of those regressions. Putting all those analytical functions into a package made code clearer and easier to read, and also made sure that no one forgot important options (e.g. to always use robust standard errors).</p>
</div>
<div id="report-templates" class="section level3">
<h3>Report Templates</h3>
<p>Did you know you can include RMarkdown templates in a package? It’s awesome.</p>
<div class="figure">
<img src="/post/2019-02-27-upgrading-to-r-4-write-a-package_files/Screen%20Shot%202019-02-27%20at%2012.59.54%20PM.png" alt="Look ma, analysis templates!" />
<p class="caption">Look ma, analysis templates!</p>
</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>My favorite is Hadley Wickham’s <em><a href="http://r-pkgs.had.co.nz/">R Packages</a></em>.<a href="#fnref1">↩</a></p></li>
</ol>
</div>

    </div>
  </article>

  


</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" alt="Img link to Hugo website" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    

    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-133127514-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>

